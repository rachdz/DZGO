<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DZGO ðŸ‡©ðŸ‡¿</title>
<style>
body{margin:0;font:16px Arial;background:#0f1417;color:#fff}
.w{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
.c{width:880px;max-width:100%;text-align:center}
.h{font-size:56px;font-weight:900;letter-spacing:-1px;margin:0 0 6px}
.sub{opacity:.9;font-weight:900;margin:0 0 18px}
.b{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
#q,#pmax{padding:14px 16px;border:1px solid #2a333a;border-radius:999px;font-size:16px;outline:none;background:#0b0f12;color:#fff}
#q{width:520px;max-width:100%}
#pmax{width:160px}
button{padding:12px 16px;border-radius:999px;border:1px solid #2a333a;background:#0b0f12;color:#fff;cursor:pointer;font-weight:900}
button:hover{filter:brightness(1.12)}
.i{font-size:13px;opacity:.8;margin-top:10px;line-height:1.35}
.p{margin-top:18px;text-align:left;border:1px solid #2a333a;border-radius:16px;padding:14px;background:#0b0f12}
.r{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
.k{font-size:12px;padding:6px 10px;border:1px solid #2a333a;border-radius:999px;background:#0f1417}
.m{width:100%;margin-top:10px;border:1px solid #2a333a;border-radius:12px;background:#0f1417;padding:10px;font-size:13px;white-space:pre-wrap}
.u{width:100%;margin-top:10px;border:1px solid #2a333a;border-radius:12px;background:#0f1417;padding:10px;font-size:12px;word-break:break-all;opacity:.9}
a{color:#3ddc84;text-decoration:none;font-weight:900}
a:hover{text-decoration:underline}
.green{color:#3ddc84}
</style>
</head>
<body>
<div class="w"><div class="c">
  <div class="h"><span class="green">DZGO</span> ðŸ‡©ðŸ‡¿</div>
  <div class="sub">DZ Network Invest</div>

  <div class="b">
    <input id="q" placeholder="Rechercher sur Leboncoin (PS4, Dyson Airwrap, voiture...)" autocomplete="off">
    <input id="pmax" inputmode="numeric" placeholder="Prix max (â‚¬)">
    <button id="go" type="button">Rechercher</button>
  </div>

  <div class="i">RÃ¨gles fixes : <b>30 km</b> autour de Montceau â€¢ <b>Particuliers</b> â€¢ <b>RÃ©cent</b> â€¢ <b>Prix max auto</b> si produit connu (ou manuel).</div>

  <div class="p">
    <div class="r">
      <div class="k" id="v">Verdict : â€”</div>
      <div class="k" id="cap">Prix max : â€”</div>
      <div class="k"><a id="link" href="#" target="_blank" rel="noreferrer">Ouvrir dans un nouvel onglet</a></div>
      <button id="copy" type="button">Copier le message</button>
    </div>
    <div class="m" id="msg"></div>
    <div class="u" id="dbg">URL : â€”</div>
  </div>
</div></div>

<script>
(()=> {
  const FIX_LOC="Montceau-les-Mines_71300__46.67817_4.36666_30000"; // 30 km
  const MSG="Bonjour, Je suis intÃ©ressÃ©, lâ€™article est-il toujours disponible ? Je peux venir rapidement. Merci.";

  const SYN={
    "ps4 pro":"ps4","playstation 4":"ps4","ps4 slim":"ps4 slim",
    "ps5 digital":"ps5","switch oled":"nintendo switch","xbox x":"xbox series x"
  };
  const CAP={"ps4":120,"ps4 slim":140,"ps5":350,"xbox series x":350,"nintendo switch":200,"dyson airwrap":280};

  const $=id=>document.getElementById(id);
  const q=$("q"), pmax=$("pmax"), go=$("go"), v=$("v"), cap=$("cap"), link=$("link"), copy=$("copy"), msg=$("msg"), dbg=$("dbg");
  msg.textContent=MSG;

  const norm=s=>String(s||"").trim().toLowerCase().replace(/\s+/g," ");
  const onlyDigits=s=>String(s||"").replace(/[^\d]/g,""); // enlÃ¨ve "â‚¬", "e", espaces...

  function buildUrl(){
    let t=norm(q.value);
    if(!t) return null;
    if(SYN[t]) t=SYN[t];

    // Prix max: si l'utilisateur tape un nombre -> prioritaire, sinon CAP auto
    const manual = Number(onlyDigits(pmax.value||""));
    const auto = (typeof CAP[t]==="number") ? CAP[t] : null;
    const max = (manual>0) ? manual : auto;

    let url="https://www.leboncoin.fr/recherche?";
    url+="text="+encodeURIComponent(t);
    url+="&locations="+encodeURIComponent(FIX_LOC);
    url+="&owner_type=private";
    url+="&sort=time&order=desc"; // âœ… RÃ‰CENT

    if(max){
      url+="&price=0-"+max;
      cap.textContent="Prix max : "+max+" â‚¬"+(manual>0?" (manuel)":" (auto)");
      v.textContent="Verdict : FiltrÃ© (rÃ©cent + prix max)";
    }else{
      cap.textContent="Prix max : (non dÃ©fini)";
      v.textContent="Verdict : Recherche libre (rÃ©cent + rÃ¨gles fixes)";
    }
    return url;
  }

  function refresh(){
    const url=buildUrl();
    if(!url){
      v.textContent="Verdict : â€”";
      cap.textContent="Prix max : â€”";
      link.href="#";
      dbg.textContent="URL : â€”";
      return;
    }
    link.href=url;
    dbg.textContent="URL : "+url;
  }

  function run(){
    const url=buildUrl();
    if(!url){ alert("Tape un produit."); return; }
    window.location.assign(url);
  }

  function copyMsg(){
    const done=()=>{ copy.textContent="CopiÃ© âœ…"; setTimeout(()=>copy.textContent="Copier le message",1200); };
    if(navigator.clipboard?.writeText){
      navigator.clipboard.writeText(MSG).then(done).catch(()=>prompt("Copie le message :",MSG));
    }else prompt("Copie le message :",MSG);
  }

  go.onclick=run;
  q.oninput=refresh;
  pmax.oninput=refresh;
  q.onkeydown=e=>{ if(e.key==="Enter"){ e.preventDefault(); run(); } };
  pmax.onkeydown=e=>{ if(e.key==="Enter"){ e.preventDefault(); run(); } };
  copy.onclick=copyMsg;

  refresh();
  setTimeout(()=>{ try{ q.focus(); }catch(e){} },50);
})();
</script>
</body>
</html>
